<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/PR-SVG-20010719/DTD/svg10.dtd">
<svg width="42cm" height="34cm" viewBox="185 539 840 672" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <ellipse style="fill: #000000" cx="196" cy="598.67" rx="10" ry="10"/>
  <g>
    <rect style="fill: #ffffff" x="320" y="540" width="46.3" height="36"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="320" y="540" width="46.3" height="36"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="343.15" y="562.8">
      <tspan x="343.15" y="562.8">:GUI</tspan>
    </text>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" x1="330" y1="565.45" x2="356.3" y2="565.45"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="585" y="540" width="98.85" height="36"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="585" y="540" width="98.85" height="36"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="634.425" y="562.8">
      <tspan x="634.425" y="562.8">:UserManager</tspan>
    </text>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" x1="595" y1="565.45" x2="673.85" y2="565.45"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="897" y="540" width="126.05" height="36"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="897" y="540" width="126.05" height="36"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="960.025" y="562.8">
      <tspan x="960.025" y="562.8">:DatabaseManager</tspan>
    </text>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" x1="907" y1="565.45" x2="1013.05" y2="565.45"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="343.15" y1="576" x2="343.15" y2="600"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="343.15" y1="790" x2="343.15" y2="814"/>
    <rect style="fill: #ffffff" x="336.15" y="600" width="14" height="190"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="336.15" y="600" width="14" height="190"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="634.426" y1="576" x2="634.426" y2="600"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="634.426" y1="1170" x2="634.426" y2="1175"/>
    <rect style="fill: #ffffff" x="627.426" y="600" width="14" height="570"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="627.426" y="600" width="14" height="570"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="960.024" y1="576" x2="960.024" y2="936"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="960.024" y1="1166" x2="960.024" y2="1175"/>
    <rect style="fill: #ffffff" x="953.024" y="936" width="14" height="230"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="953.024" y="936" width="14" height="230"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="319.151" y1="599.826" x2="206" y2="598.67"/>
    <polygon style="fill: #000000" points="319.1,604.826 335.15,599.99 319.202,594.827 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="319.1,604.826 335.15,599.99 319.202,594.827 "/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="610.426" y1="625" x2="350.15" y2="625"/>
    <polygon style="fill: #000000" points="610.426,630 626.426,625 610.426,620 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="610.426,630 626.426,625 610.426,620 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="482" y="620">ResetPassword(username, email, role)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="641.426" y1="640" x2="671" y2="640"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="671" y1="640" x2="671" y2="672"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="658.426" y1="672" x2="671" y2="672"/>
    <polygon style="fill: #000000" points="658.426,667 642.426,672 658.426,677 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="658.426,667 642.426,672 658.426,677 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="754" y="637">GenerateSecretCode(username, email)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="641.426" y1="700" x2="672" y2="700"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="672" y1="700" x2="672" y2="732"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="658.426" y1="732" x2="672" y2="732"/>
    <polygon style="fill: #000000" points="658.426,727 642.426,732 658.426,737 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="658.426,727 642.426,732 658.426,737 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="710" y="696">SendCode(email, code)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="350.15" y1="650" x2="384" y2="650"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="384" y1="650" x2="384" y2="684"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="367.15" y1="684" x2="384" y2="684"/>
    <polygon style="fill: #000000" points="367.15,679 351.15,684 367.15,689 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="367.15,679 351.15,684 367.15,689 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="418" y="647">Redirect(codePageUrl)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="610.426" y1="755" x2="350.15" y2="755"/>
    <polygon style="fill: #000000" points="610.426,760 626.426,755 610.426,750 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="610.426,760 626.426,755 610.426,750 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="489" y="752">SendCode(codeFromEmail)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="641.426" y1="775" x2="675" y2="775"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="675" y1="775" x2="675" y2="808"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="658.426" y1="808" x2="675" y2="808"/>
    <polygon style="fill: #000000" points="658.426,803 642.426,808 658.426,813 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="658.426,803 642.426,808 658.426,813 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="770.5" y="773">verified = CheckCode(codeFromEmail, code)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="641.426" y1="825" x2="678" y2="825"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="678" y1="825" x2="678" y2="860"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="658.426" y1="860" x2="678" y2="860"/>
    <polygon style="fill: #000000" points="658.426,855 642.426,860 658.426,865 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="658.426,855 642.426,860 658.426,865 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="809.5" y="822.5">[verified = False] IncrementResetCounter(username, role)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="641.426" y1="880" x2="678" y2="880"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="678" y1="880" x2="678" y2="911"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="658.426" y1="911" x2="678" y2="911"/>
    <polygon style="fill: #000000" points="658.426,906 642.426,911 658.426,916 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="658.426,906 642.426,911 658.426,916 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="763.406" y="876.7">count = GetResetCounter(username, role)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="936.024" y1="935.945" x2="641.426" y2="935"/>
    <polygon style="fill: #000000" points="936.008,940.945 952.024,935.997 936.04,930.945 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="936.008,940.945 952.024,935.997 936.04,930.945 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="782.5" y="930.5">[count = 2] LockAccount(username, email, role)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke-dasharray: 8; stroke: #000000" x1="407.2" y1="950.371" x2="627.426" y2="950"/>
    <polygon style="fill: #000000" points="407.192,945.371 391.2,950.398 407.208,955.371 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="407.192,945.371 391.2,950.398 407.208,955.371 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="521" y="946">[verified = False || count = 2]</text>
  </g>
  <g>
    <ellipse style="fill: #ffffff" cx="375.2" cy="950.4" rx="15" ry="15"/>
    <ellipse style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" cx="375.2" cy="950.4" rx="15" ry="15"/>
    <ellipse style="fill: #000000" cx="375.2" cy="950.4" rx="10" ry="10"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="343.15" y1="790" x2="343.15" y2="1000"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="343.15" y1="1100" x2="343.15" y2="1210"/>
    <rect style="fill: #ffffff" x="336.15" y="1000" width="14" height="100"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="336.15" y="1000" width="14" height="100"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke-dasharray: 8; stroke: #000000" x1="367.15" y1="1000" x2="627.426" y2="1000"/>
    <polygon style="fill: #000000" points="367.15,995 351.15,1000 367.15,1005 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="367.15,995 351.15,1000 367.15,1005 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="487" y="997">verified</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="350.15" y1="1025" x2="386" y2="1025"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="386" y1="1025" x2="386" y2="1059"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="367.15" y1="1059" x2="386" y2="1059"/>
    <polygon style="fill: #000000" points="367.15,1054 351.15,1059 367.15,1064 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="367.15,1054 351.15,1059 367.15,1064 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="468" y="1020">[verified = True] Redirect(resetPageUrl)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="610.426" y1="1085" x2="350.15" y2="1085"/>
    <polygon style="fill: #000000" points="610.426,1090 626.426,1085 610.426,1080 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="610.426,1090 626.426,1085 610.426,1080 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="490" y="1081">UpdatePassword(username, password, role)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="936.024" y1="1155.95" x2="641.426" y2="1155"/>
    <polygon style="fill: #000000" points="936.008,1160.95 952.024,1156 936.04,1150.95 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="936.008,1160.95 952.024,1156 936.04,1150.95 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="801.5" y="1152">UpdatePassword(username, saltPass, role)</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="641.426" y1="1105" x2="678.184" y2="1105"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="678.184" y1="1105" x2="678.184" y2="1133.7"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="658.426" y1="1133.7" x2="678.184" y2="1133.7"/>
    <polygon style="fill: #000000" points="658.426,1128.7 642.426,1133.7 658.426,1138.7 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="658.426,1128.7 642.426,1133.7 658.426,1138.7 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="734" y="1101">saltPass = HashSalt(password)</text>
  </g>
  <text font-size="14.6756" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:700" x="253.275" y="566.2">
    <tspan x="253.275" y="566.2">Reset Password</tspan>
  </text>
</svg>
